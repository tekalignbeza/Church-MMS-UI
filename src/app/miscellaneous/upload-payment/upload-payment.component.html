<div class="church-upload-dialog">
  <div class="church-section-content">
    <h2 class="upload-header">Upload Payment</h2>
    <form [formGroup]="uploadForm" (ngSubmit)="uploadFile()" class="church-form">
        <div class="church-form-group">
          <mat-form-field appearance="outline" class="church-full-width">
            <mat-label>Start Date</mat-label>
            <input matInput [matDatepicker]="startPicker" 
                   formControlName="fromDate" 
                   placeholder="Select start date">
            <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
            <mat-datepicker #startPicker></mat-datepicker>
            <mat-error *ngIf="uploadForm.get('fromDate')?.hasError('required')">
              Start date is required
            </mat-error>
          </mat-form-field>
        </div>

        <div class="church-form-group">
          <mat-form-field appearance="outline" class="church-full-width">
            <mat-label>End Date</mat-label>
            <input matInput [matDatepicker]="endPicker" 
                   formControlName="toDate" 
                   placeholder="Select end date">
            <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
            <mat-datepicker #endPicker></mat-datepicker>
            <mat-error *ngIf="uploadForm.get('toDate')?.hasError('required')">
              End date is required
            </mat-error>
            <mat-error *ngIf="uploadForm.get('toDate')?.hasError('dateRange')">
              End date must be after start date
            </mat-error>
          </mat-form-field>
        </div>

        <div class="church-form-group">
          <mat-form-field appearance="outline" class="church-full-width">
            <mat-label>Excel File</mat-label>
            <input matInput readonly 
                   [value]="selectedFile?.name || ''" 
                   placeholder="Choose Excel file">
            <button mat-icon-button matSuffix type="button" (click)="fileInput.click()">
              <mat-icon>attach_file</mat-icon>
            </button>
            <input #fileInput type="file" hidden 
                   (change)="onFileSelected($event)" 
                   accept=".xls,.xlsx">
            <mat-error *ngIf="!selectedFile && isFormSubmitted">
              Excel file is required
            </mat-error>
          </mat-form-field>
        </div>

        <div class="church-form-actions">
          <button class="church-btn church-btn-primary" 
                  type="submit"
                  [disabled]="uploadForm.invalid || !selectedFile || isUploading">
            <mat-spinner *ngIf="isUploading" [diameter]="18" class="church-spinner"></mat-spinner>
            <span *ngIf="!isUploading">Upload</span>
            <span *ngIf="isUploading">Uploading...</span>
          </button>
          <button class="church-btn church-btn-outline" 
                  type="button"
                  (click)="cancel()">
            Cancel
          </button>
        </div>
      </form>
  </div>
</div>